## Better way 24. None과 독스트링을 사용해 동적인 디폴트 인자를 지정하라

```python
from time import sleep
from datetime import datetime

def log(message, when=datetime.now()):
    print(f'{when}: {message}')

log('안녕!')
sleep(0.1)
log('다시 안녕!')

>>>
2021-07-18 21:07:28.877045: 안녕!
2021-07-18 21:07:28.877045: 다시 안녕!
```

디폴트 인자는 이런 식으로 작동하지 않는다. 함수가 정의되는 시점에 datetime.now가 단 한 번만 호출되기 때문에 타임스탬프가 항상 같다. 디폴트 인자의 값은 모듈이 로드될 때 단 한 번만 평가되는데, 보통 프로그램이 시작할 때 모듈을 로드하는 경우가 많다.

이런 경우 원하는 동작을 달성하는 파이썬의 일반적인 관례는 디폴트 값으로 None을 지정하고 실제 동작을 독스트링에 문서화하는 것이다. 

```python
def log(message, when=None):
    """메시지와 타임스탬프를 로그에 남긴다.

    Args:
        message: 출력할 메시지.
        when: 메시지가 발생한 시각(datetime).
            디폴트 값은 현재 시간이다.
    """
    if when is None:
        when = datetime.now()
    print(f'{when}: {message}')

log('안녕!')
sleep(0.1)
log('다시 안녕!')
>>>

2021-07-18 21:18:20.174998: 안녕!
2021-07-18 21:18:20.277991: 다시 안녕!
```

**기억해야 할 내용**
- 디폴트 인자 값은 그 인자가 포함된 함수 정의가 속한 모듈이 로드되는 시점에 단 한 번만 평가된다. 이로 인해 동적인 값({}, [], datetime.now() 등)의 경우 이상한 동작이 일어날 수 있다.
- 동적인 값을 가질 수 있는 키워드 인자의 디폴트 값을 표현할 때는 None을 사용하라. 그리고 함수의 독스트링에 실제 동적인 디폴트 인자가 어떻게 작동하는지 문서화해두라.
- 타입 애너테이션을 사용할 때도 None을 사용해 키워드 인자의 디폴트 값을 표현하는 방식을 적용할 수 있다.