## Better way 32. 긴 리스트 컴프리헨션보다는 제너레이터 식을 사용하라

파일을 읽어서 각 줄에 들어 있는 문자 수를 반환하고 싶다고 하자. 이를 리스트 컴프리헨션으로 하려면 파일 각 줄의 길이를 메모리에 저장해야 한다. 파일이 아주 큰 경우 리스트 컴프리헨션을 사용하는 것이 문제가 될 수 있다.

이 문제를 해결하기 위해 파이썬은 제너레이터 식(generator expression)을 제공한다. 제너레이터 식은 리스트 컴프리헨션과 제너레이터를 일반화한 것이다. 제너레이터 식을 실행해도 출력 시퀀스 전체가 실체화되지는 않는다. 그 대신 제너레이터 식에 들어 있는 식으로부터 원소를 하나씩 만들어내는 이터레이터가 생성된다.

() 사이에 리스트 컴프리헨션과 비슷한 구문을 넣어 제너레이터 식을 만들 수 있다.

```python
it = (len(x) for x in open('my_file.txt'))
print(it)

>>>
<generator object <genexpr> at 0x7ff94a8d8ad0>

print(next(it))
print(next(it))

>>>
100
57
```

제너레이터 식을 사용하면 메모리를 모두 소모하는 것을 염려할 필요 없이 원소를 원하는 대로 가져와 소비할 수 있다.

제너레이터 식의 또 다른 강력한 특징은 두 제너레이터 식을 합성할 수 있다는 점이다. 다음 코드에서는 앞에서 본 제너레이터 식이 반환한 이터레이터를 다른 제너레이터 식의 입력으로 사용한다.

```python
roots = ((x, x**0.5) for x in it)
```

**기억해야 할 내용**
- 입력이 크면 메모리를 너무 많이 사용하기 때문에 리스트 컴프리헨션은 문제를 일으킬 수 있다.
- 제너레이터 식은 이터레이터처럼 한 번에 원소를 하나씩 출력하기 때문에 메모리 문제를 피할 수 있다.
- 제너레이터 식이 반환한 이터레이터를 다른 제너레이터 식의 하위 식으로 사용함으로써 제너레이터 식을 서로 합성할 수 있다.
- 서로 연결된 제너레이터 식은 매우 빠르게 실행되며 메모리도 효율적으로 사용한다.